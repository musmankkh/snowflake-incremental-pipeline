{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.6", "generated_at": "2026-02-19T06:57:37.487237Z", "invocation_id": "a5cf51fe-c141-4ef2-b4f2-a3e743dea8ad", "invocation_started_at": "2026-02-19T06:57:13.463859Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-19T06:57:18.888941Z", "completed_at": "2026-02-19T06:57:18.930346Z"}, {"name": "execute", "started_at": "2026-02-19T06:57:18.930346Z", "completed_at": "2026-02-19T06:57:22.324377Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.4452531337738037, "adapter_response": {"_message": "SUCCESS 3054", "code": "SUCCESS", "rows_affected": 3054, "query_id": "01c28301-3202-5b3f-0013-d4520009884e", "rows_inserted": 3054, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 3054", "failures": null, "unique_id": "model.sales_pipelines.stg_sales", "compiled": true, "compiled_code": "\n\nWITH raw_data AS (\n    SELECT * \n    FROM INCREMENTALETL.LANDINGZONE.RAW_SALES\n),\n\nstaged AS (\n    SELECT\n        -- IDs\n        CAST(INVOICENO AS VARCHAR)    AS invoice_no,\n        CAST(STOCKCODE AS VARCHAR)    AS stock_code,\n        CAST(DESCRIPTION AS VARCHAR)  AS description,\n\n        -- Quantities & Prices\n        TRY_CAST(QUANTITY AS INT)      AS quantity,\n        TRY_CAST(UNITPRICE AS FLOAT)   AS unit_price,\n        TRY_CAST(DISCOUNT AS FLOAT)    AS discount,\n        TRY_CAST(SHIPPINGCOST AS FLOAT) AS shipping_cost,\n        TRY_CAST(CUSTOMERID AS FLOAT)  AS customer_id,\n\n        -- Convert once\n        TRY_TO_TIMESTAMP(INVOICEDATE, 'YYYY-MM-DD HH24:MI:SS') AS invoice_date,\n\n        TRIM(UPPER(COUNTRY))            AS country,\n        TRIM(UPPER(PAYMENTMETHOD))      AS payment_method,\n        TRIM(UPPER(CATEGORY))           AS category,\n        TRIM(UPPER(SALESCHANNEL))       AS sales_channel,\n        TRIM(UPPER(RETURNSTATUS))       AS return_status,\n        TRIM(UPPER(SHIPMENTPROVIDER))   AS shipment_provider,\n        TRIM(UPPER(WAREHOUSELOCATION))  AS warehouse_location,\n        TRIM(UPPER(ORDERPRIORITY))      AS order_priority,\n\n        CURRENT_TIMESTAMP()             AS stg_loaded_at\n\n    FROM raw_data\n),\n\nvalidated AS (\n    SELECT\n        *,\n        YEAR(invoice_date)  AS invoice_year,\n        MONTH(invoice_date) AS invoice_month,\n\n        CASE\n            WHEN invoice_date IS NULL           THEN 'INVALID_DATE'\n            WHEN quantity IS NULL               THEN 'INVALID_QUANTITY'\n            WHEN unit_price IS NULL             THEN 'INVALID_PRICE'\n            WHEN shipping_cost < 0              THEN 'NEGATIVE_SHIPPING'\n            WHEN discount < 0 OR discount > 1   THEN 'INVALID_DISCOUNT'\n            WHEN invoice_no IS NULL             THEN 'NULL_INVOICE'\n            ELSE 'VALID'\n        END AS data_quality_flag\n    FROM staged\n)\n\nSELECT *\nFROM validated\n\n\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM INCREMENTALETL._staging.stg_sales t\n    WHERE t.invoice_year  = validated.invoice_year\n      AND t.invoice_month = validated.invoice_month\n)\n", "relation_name": "INCREMENTALETL._staging.stg_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-19T06:57:22.335195Z", "completed_at": "2026-02-19T06:57:22.335195Z"}, {"name": "execute", "started_at": "2026-02-19T06:57:22.335195Z", "completed_at": "2026-02-19T06:57:26.018265Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.684441089630127, "adapter_response": {"_message": "SUCCESS 2985", "code": "SUCCESS", "rows_affected": 2985, "query_id": "01c28301-3202-5b3f-0013-d45200098872", "rows_inserted": 2985, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 2985", "failures": null, "unique_id": "model.sales_pipelines.processed_sales", "compiled": true, "compiled_code": "\n\nWITH staging AS (\n    SELECT * \n    FROM INCREMENTALETL._staging.stg_sales\n),\n\ndeduped AS (\n    SELECT *,\n        ROW_NUMBER() OVER (\n            PARTITION BY invoice_no, stock_code\n            ORDER BY stg_loaded_at DESC\n        ) AS row_num\n    FROM staging\n),\n\ncleaned AS (\n    SELECT\n        invoice_no,\n        stock_code,\n        description,\n        quantity,\n        unit_price,\n        discount,\n        shipping_cost,\n        customer_id,\n        invoice_date,\n        invoice_year,\n        invoice_month,\n        country,\n        payment_method,\n        category,\n        sales_channel,\n        return_status,\n        shipment_provider,\n        warehouse_location,\n        order_priority,\n\n        -- Derived metrics\n        ROUND(quantity * unit_price, 2) AS gross_amount,\n        ROUND(quantity * unit_price * (1 - discount), 2) AS net_amount,\n        ROUND(\n            quantity * unit_price * (1 - discount)\n            + COALESCE(shipping_cost, 0),\n        2) AS total_amount,\n\n        CASE WHEN return_status = 'RETURNED' THEN TRUE ELSE FALSE END AS is_returned,\n        CASE WHEN customer_id IS NULL THEN TRUE ELSE FALSE END AS is_guest_customer,\n\n        stg_loaded_at,\n        CURRENT_TIMESTAMP() AS processed_at\n\n    FROM deduped\n    WHERE\n        row_num = 1\n        AND data_quality_flag = 'VALID'\n        AND invoice_date IS NOT NULL\n)\n\nSELECT *\nFROM cleaned\n\n\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM INCREMENTALETL._processed.processed_sales t\n    WHERE t.invoice_year  = cleaned.invoice_year\n      AND t.invoice_month = cleaned.invoice_month\n)\n", "relation_name": "INCREMENTALETL._processed.processed_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-19T06:57:26.077208Z", "completed_at": "2026-02-19T06:57:26.097237Z"}, {"name": "execute", "started_at": "2026-02-19T06:57:26.148001Z", "completed_at": "2026-02-19T06:57:26.858102Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.800990104675293, "adapter_response": {"_message": "SUCCESS 2075", "code": "SUCCESS", "rows_affected": 2075, "query_id": "01c28301-3202-5b3f-0013-d4520009887e", "rows_inserted": 2075, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 2075", "failures": null, "unique_id": "model.sales_pipelines.dim_date", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    invoice_date::DATE AS date_key,\n    YEAR(invoice_date)  AS year,\n    MONTH(invoice_date) AS month,\n    DAY(invoice_date)   AS day,\n    DAYNAME(invoice_date) AS day_name,\n    WEEK(invoice_date)  AS week_number,\n    QUARTER(invoice_date) AS quarter\nFROM INCREMENTALETL._processed.processed_sales", "relation_name": "INCREMENTALETL._marts.dim_date", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-19T06:57:26.082187Z", "completed_at": "2026-02-19T06:57:26.097237Z"}, {"name": "execute", "started_at": "2026-02-19T06:57:26.155062Z", "completed_at": "2026-02-19T06:57:27.587727Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.5306155681610107, "adapter_response": {"_message": "SUCCESS 32293", "code": "SUCCESS", "rows_affected": 32293, "query_id": "01c28301-3202-5b3f-0013-d45200098896", "rows_inserted": 32293, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 32293", "failures": null, "unique_id": "model.sales_pipelines.dim_products", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    stock_code,\n    description,\n    category\nFROM INCREMENTALETL._processed.processed_sales", "relation_name": "INCREMENTALETL._marts.dim_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-19T06:57:26.067432Z", "completed_at": "2026-02-19T06:57:26.097237Z"}, {"name": "execute", "started_at": "2026-02-19T06:57:26.097237Z", "completed_at": "2026-02-19T06:57:27.616638Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.5610408782958984, "adapter_response": {"_message": "SUCCESS 44640", "code": "SUCCESS", "rows_affected": 44640, "query_id": "01c28301-3202-5b3f-0013-d4520009888e", "rows_inserted": 44640, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 44640", "failures": null, "unique_id": "model.sales_pipelines.dim_customers", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    customer_id,\n    country,\n    payment_method,\n    sales_channel,\n    is_guest_customer,\n    MIN(invoice_date) AS first_purchase_date,\n    MAX(invoice_date) AS last_purchase_date,\n    COUNT(DISTINCT invoice_no) AS total_orders\nFROM INCREMENTALETL._processed.processed_sales\nWHERE customer_id IS NOT NULL\nGROUP BY\n    customer_id,\n    country,\n    payment_method,\n    sales_channel,\n    is_guest_customer", "relation_name": "INCREMENTALETL._marts.dim_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-19T06:57:26.091713Z", "completed_at": "2026-02-19T06:57:26.155062Z"}, {"name": "execute", "started_at": "2026-02-19T06:57:26.164564Z", "completed_at": "2026-02-19T06:57:29.280623Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.229045867919922, "adapter_response": {"_message": "SUCCESS 2985", "code": "SUCCESS", "rows_affected": 2985, "query_id": "01c28301-3202-5b3f-0013-d4520009889e", "rows_inserted": 2985, "rows_deleted": 0, "rows_updated": 0, "rows_duplicates": 0}, "message": "SUCCESS 2985", "failures": null, "unique_id": "model.sales_pipelines.fact_sales", "compiled": true, "compiled_code": "\n\nSELECT\n    invoice_no,\n    stock_code,\n    customer_id,\n    invoice_date::DATE AS date_key,\n\n    quantity,\n    unit_price,\n    discount,\n    shipping_cost,\n\n    gross_amount,\n    net_amount,\n    total_amount,\n\n    is_returned,\n    processed_at\n\nFROM INCREMENTALETL._processed.processed_sales\n\n\nWHERE processed_at > (SELECT MAX(processed_at) FROM INCREMENTALETL._marts.fact_sales)\n", "relation_name": "INCREMENTALETL._marts.fact_sales", "batch_results": null}], "elapsed_time": 21.540027141571045, "args": {"skip_nodes_if_on_run_start_fails": false, "require_yaml_configuration_for_mf_time_spines": false, "populate_cache": true, "strict_mode": false, "use_fast_test_edges": false, "empty": false, "log_format": "default", "partial_parse": true, "show_all_deprecations": false, "require_resource_names_without_spaces": true, "log_level": "info", "require_batched_execution_for_custom_microbatch_strategy": false, "validate_macro_args": false, "require_unique_project_resource_names": false, "require_generic_test_arguments_property": true, "log_file_max_bytes": 10485760, "vars": {}, "write_json": true, "source_freshness_run_project_hooks": true, "version_check": true, "favor_state": false, "macro_debugging": false, "upload_to_artifacts_ingest_api": false, "use_colors_file": true, "log_path": "D:\\snowflake-incremental-pipeline\\dbt_project\\logs", "which": "run", "select": [], "exclude": [], "cache_selected_only": false, "log_format_file": "debug", "profiles_dir": "D:\\snowflake-incremental-pipeline\\dbt_project", "warn_error_options": {"error": [], "warn": [], "silence": []}, "introspect": true, "partial_parse_file_diff": true, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors": true, "printer_width": 80, "state_modified_compare_vars": false, "require_nested_cumulative_type_params": false, "static_parser": true, "state_modified_compare_more_unrendered_values": false, "invocation_command": "dbt run", "defer": false, "indirect_selection": "eager", "quiet": false, "require_all_warnings_handled_by_warn_error": false, "log_level_file": "debug", "print": true, "require_ref_searches_node_package_before_root": false, "project_dir": "D:\\snowflake-incremental-pipeline\\dbt_project", "show_resource_report": false, "send_anonymous_usage_stats": true}}