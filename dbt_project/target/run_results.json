{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.6", "generated_at": "2026-02-19T05:52:38.115218Z", "invocation_id": "cd956227-bbf0-4854-b570-64eb315f217d", "invocation_started_at": "2026-02-19T05:52:22.385150Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-19T05:52:27.422265Z", "completed_at": "2026-02-19T05:52:27.439388Z"}, {"name": "execute", "started_at": "2026-02-19T05:52:27.453905Z", "completed_at": "2026-02-19T05:52:31.181138Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.7749691009521484, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01c282c0-3202-5b3f-0013-d4520009751a"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.sales_pipelines.stg_sales", "compiled": true, "compiled_code": "\n\nWITH raw_data AS (\n    SELECT * \n    FROM INCREMENTALETL.LANDINGZONE.RAW_SALES\n),\n\nstaged AS (\n    SELECT\n        -- IDs\n        CAST(INVOICENO AS VARCHAR)    AS invoice_no,\n        CAST(STOCKCODE AS VARCHAR)    AS stock_code,\n        CAST(DESCRIPTION AS VARCHAR)  AS description,\n\n        -- Quantities & Prices\n        TRY_CAST(QUANTITY AS INT)      AS quantity,\n        TRY_CAST(UNITPRICE AS FLOAT)   AS unit_price,\n        TRY_CAST(DISCOUNT AS FLOAT)    AS discount,\n        TRY_CAST(SHIPPINGCOST AS FLOAT) AS shipping_cost,\n        TRY_CAST(CUSTOMERID AS FLOAT)  AS customer_id,\n\n        -- Convert once\n        TRY_TO_TIMESTAMP(INVOICEDATE, 'YYYY-MM-DD HH24:MI:SS') AS invoice_date,\n\n        TRIM(UPPER(COUNTRY))            AS country,\n        TRIM(UPPER(PAYMENTMETHOD))      AS payment_method,\n        TRIM(UPPER(CATEGORY))           AS category,\n        TRIM(UPPER(SALESCHANNEL))       AS sales_channel,\n        TRIM(UPPER(RETURNSTATUS))       AS return_status,\n        TRIM(UPPER(SHIPMENTPROVIDER))   AS shipment_provider,\n        TRIM(UPPER(WAREHOUSELOCATION))  AS warehouse_location,\n        TRIM(UPPER(ORDERPRIORITY))      AS order_priority,\n\n        CURRENT_TIMESTAMP()             AS stg_loaded_at\n\n    FROM raw_data\n),\n\nvalidated AS (\n    SELECT\n        *,\n        YEAR(invoice_date)  AS invoice_year,\n        MONTH(invoice_date) AS invoice_month,\n\n        CASE\n            WHEN invoice_date IS NULL           THEN 'INVALID_DATE'\n            WHEN quantity IS NULL               THEN 'INVALID_QUANTITY'\n            WHEN unit_price IS NULL             THEN 'INVALID_PRICE'\n            WHEN shipping_cost < 0              THEN 'NEGATIVE_SHIPPING'\n            WHEN discount < 0 OR discount > 1   THEN 'INVALID_DISCOUNT'\n            WHEN invoice_no IS NULL             THEN 'NULL_INVOICE'\n            ELSE 'VALID'\n        END AS data_quality_flag\n    FROM staged\n)\n\nSELECT *\nFROM validated\n\n\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM INCREMENTALETL._staging.stg_sales t\n    WHERE t.invoice_year  = validated.invoice_year\n      AND t.invoice_month = validated.invoice_month\n)\n", "relation_name": "INCREMENTALETL._staging.stg_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-19T05:52:31.200254Z", "completed_at": "2026-02-19T05:52:31.200254Z"}, {"name": "execute", "started_at": "2026-02-19T05:52:31.200254Z", "completed_at": "2026-02-19T05:52:35.856447Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.658313989639282, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01c282c0-3202-5b3f-0013-d4520009753e"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.sales_pipelines.processed_sales", "compiled": true, "compiled_code": "\n\nWITH staging AS (\n    SELECT * \n    FROM INCREMENTALETL._staging.stg_sales\n),\n\ndeduped AS (\n    SELECT *,\n        ROW_NUMBER() OVER (\n            PARTITION BY invoice_no, stock_code\n            ORDER BY stg_loaded_at DESC\n        ) AS row_num\n    FROM staging\n),\n\ncleaned AS (\n    SELECT\n        invoice_no,\n        stock_code,\n        description,\n        quantity,\n        unit_price,\n        discount,\n        shipping_cost,\n        customer_id,\n        invoice_date,\n        invoice_year,\n        invoice_month,\n        country,\n        payment_method,\n        category,\n        sales_channel,\n        return_status,\n        shipment_provider,\n        warehouse_location,\n        order_priority,\n\n        -- Derived metrics\n        ROUND(quantity * unit_price, 2) AS gross_amount,\n        ROUND(quantity * unit_price * (1 - discount), 2) AS net_amount,\n        ROUND(\n            quantity * unit_price * (1 - discount)\n            + COALESCE(shipping_cost, 0),\n        2) AS total_amount,\n\n        CASE WHEN return_status = 'RETURNED' THEN TRUE ELSE FALSE END AS is_returned,\n        CASE WHEN customer_id IS NULL THEN TRUE ELSE FALSE END AS is_guest_customer,\n\n        stg_loaded_at,\n        CURRENT_TIMESTAMP() AS processed_at\n\n    FROM deduped\n    WHERE\n        row_num = 1\n        AND data_quality_flag = 'VALID'\n        AND invoice_date IS NOT NULL\n)\n\nSELECT *\nFROM cleaned\n\n\nWHERE NOT EXISTS (\n    SELECT 1\n    FROM INCREMENTALETL._processed.processed_sales t\n    WHERE t.invoice_year  = cleaned.invoice_year\n      AND t.invoice_month = cleaned.invoice_month\n)\n", "relation_name": "INCREMENTALETL._processed.processed_sales", "batch_results": null}], "elapsed_time": 13.268426895141602, "args": {"vars": {}, "log_level_file": "debug", "log_format_file": "debug", "state_modified_compare_more_unrendered_values": false, "require_resource_names_without_spaces": true, "show_resource_report": false, "use_fast_test_edges": false, "show_all_deprecations": false, "populate_cache": true, "log_path": "D:\\snowflake-incremental-pipeline\\dbt_project\\logs", "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors": true, "source_freshness_run_project_hooks": true, "upload_to_artifacts_ingest_api": false, "empty": false, "favor_state": false, "use_colors_file": true, "log_file_max_bytes": 10485760, "require_all_warnings_handled_by_warn_error": false, "introspect": true, "strict_mode": false, "require_explicit_package_overrides_for_builtin_materializations": true, "quiet": false, "validate_macro_args": false, "require_ref_searches_node_package_before_root": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "require_generic_test_arguments_property": true, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "project_dir": "D:\\snowflake-incremental-pipeline\\dbt_project", "version_check": true, "cache_selected_only": false, "defer": false, "static_parser": true, "partial_parse_file_diff": true, "log_format": "default", "require_yaml_configuration_for_mf_time_spines": false, "skip_nodes_if_on_run_start_fails": false, "write_json": true, "exclude": [], "select": [], "state_modified_compare_vars": false, "printer_width": 80, "profiles_dir": "D:\\snowflake-incremental-pipeline\\dbt_project", "partial_parse": true, "invocation_command": "dbt run", "log_level": "info", "macro_debugging": false, "require_unique_project_resource_names": false, "print": true, "require_nested_cumulative_type_params": false, "which": "run"}}