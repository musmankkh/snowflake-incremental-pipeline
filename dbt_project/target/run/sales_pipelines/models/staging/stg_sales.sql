-- back compat for old kwarg name
  
  begin;
    
        
            
                
                
            
                
                
            
        
    

    

    merge into INCREMENTALETL._staging.stg_sales as DBT_INTERNAL_DEST
        using INCREMENTALETL._staging.stg_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.invoice_no = DBT_INTERNAL_DEST.invoice_no
                ) and (
                    DBT_INTERNAL_SOURCE.stock_code = DBT_INTERNAL_DEST.stock_code
                )

    
    when matched then update set
        "INVOICE_NO" = DBT_INTERNAL_SOURCE."INVOICE_NO","STOCK_CODE" = DBT_INTERNAL_SOURCE."STOCK_CODE","DESCRIPTION" = DBT_INTERNAL_SOURCE."DESCRIPTION","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","UNIT_PRICE" = DBT_INTERNAL_SOURCE."UNIT_PRICE","DISCOUNT" = DBT_INTERNAL_SOURCE."DISCOUNT","SHIPPING_COST" = DBT_INTERNAL_SOURCE."SHIPPING_COST","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","INVOICE_DATE" = DBT_INTERNAL_SOURCE."INVOICE_DATE","COUNTRY" = DBT_INTERNAL_SOURCE."COUNTRY","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","CATEGORY" = DBT_INTERNAL_SOURCE."CATEGORY","SALES_CHANNEL" = DBT_INTERNAL_SOURCE."SALES_CHANNEL","RETURN_STATUS" = DBT_INTERNAL_SOURCE."RETURN_STATUS","SHIPMENT_PROVIDER" = DBT_INTERNAL_SOURCE."SHIPMENT_PROVIDER","WAREHOUSE_LOCATION" = DBT_INTERNAL_SOURCE."WAREHOUSE_LOCATION","ORDER_PRIORITY" = DBT_INTERNAL_SOURCE."ORDER_PRIORITY","STG_LOADED_AT" = DBT_INTERNAL_SOURCE."STG_LOADED_AT","INVOICE_YEAR" = DBT_INTERNAL_SOURCE."INVOICE_YEAR","INVOICE_MONTH" = DBT_INTERNAL_SOURCE."INVOICE_MONTH","DATA_QUALITY_FLAG" = DBT_INTERNAL_SOURCE."DATA_QUALITY_FLAG"
    

    when not matched then insert
        ("INVOICE_NO", "STOCK_CODE", "DESCRIPTION", "QUANTITY", "UNIT_PRICE", "DISCOUNT", "SHIPPING_COST", "CUSTOMER_ID", "INVOICE_DATE", "COUNTRY", "PAYMENT_METHOD", "CATEGORY", "SALES_CHANNEL", "RETURN_STATUS", "SHIPMENT_PROVIDER", "WAREHOUSE_LOCATION", "ORDER_PRIORITY", "STG_LOADED_AT", "INVOICE_YEAR", "INVOICE_MONTH", "DATA_QUALITY_FLAG")
    values
        ("INVOICE_NO", "STOCK_CODE", "DESCRIPTION", "QUANTITY", "UNIT_PRICE", "DISCOUNT", "SHIPPING_COST", "CUSTOMER_ID", "INVOICE_DATE", "COUNTRY", "PAYMENT_METHOD", "CATEGORY", "SALES_CHANNEL", "RETURN_STATUS", "SHIPMENT_PROVIDER", "WAREHOUSE_LOCATION", "ORDER_PRIORITY", "STG_LOADED_AT", "INVOICE_YEAR", "INVOICE_MONTH", "DATA_QUALITY_FLAG")

;
    commit;